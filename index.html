<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Nadella Spread</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <script src="script.js" defer></script>
  <link rel="stylesheet" href="style.css" />
  <style>
    #logo {
      height: 70px;
      vertical-align: middle;
      margin-right: 12px;
    }
    .loading {
      display: none;
      font-weight: bold;
      color: #8d5524;
      animation: fadeInOut 2s infinite;
    }
    @keyframes fadeInOut {
      0% { opacity: 0; }
      50% { opacity: 1; }
      100% { opacity: 0; }
    }
  </style>
</head>
<body>
  <header>
    <h1>
      <img id="logo" src="favicon.png" alt="Nadella Spread Jar Logo" title="Satya would be proud." />
      Nadella Spread
    </h1>
    <p>Visualize M365 license mix, client margin, and CSP optimization for your MSP</p>
    <p><a href="calculator.html" style="font-size: 1.1rem; color: #0078D4;">â†’ Open Single Client Calculator</a></p>
    <div class="loading" id="loadingText">Spreading margins like Nutella...</div>
  </header>

  <section>
    <h2>Upload Tenant License CSV</h2>
    <input type="file" id="csvInput" accept=".csv" />
    <button id="downloadCSV">Download CSV</button>

    <div style="margin-top: 20px;">
      <label for="optimizedCost">CSP Annual License Cost (per license):</label>
      <input type="number" id="optimizedCost" placeholder="e.g. 221.76" />

      <label for="clientRate">Client Monthly Billing Rate (per license):</label>
      <input type="number" id="clientRate" placeholder="e.g. 22.00" />

      <label for="targetSKU" title="Defaults to Business Premium (SW-P-O365-15-M1M) if present.">Apply to SKU:</label>
      <select id="targetSKU"></select>

      <button id="applyOptimized">Apply Optimized Values</button>
    </div>

    <div id="results"></div>
  </section>
</body>
</html>
